/* 
 _  ____ _           _   
(_)/ ___| |__   __ _| |_
| | |   | '_ \ / _` | __|
| | |___| | | | (_| | |_
|_|\____|_| |_|\__,_|\__|
 _____ _____ _____ _____
|_____|_____|_____|_____|

  © _iPhoenix_
Interested in looking
under the hood, or just
want to poke around?
Start here:
http://bit.ly/iChat-Source
*/
var _iChat_VersionInfo;!function(){function e(e){var t=document.createElement("p");return t.innerText=e,t.innerHTML}fetch("https://legend-of-iphoenix.github.io/iChat/README.md").then(function(e){return e.text()}).then(function(e){(_iChat_VersionInfo={version:e.match(/N: ([^)]*)\)/)[0].substring(3).slice(0,-1),releaseDate:e.match(/E: ([^)]*)\)/)[0].substring(3).slice(0,-1),currentVersion:"0.2.1"}).version!==_iChat_VersionInfo.currentVersion&&_iChat_VersionInfo.version.endsWith("+dev")&&console.warn("A new version of iChat, "+_iChat_VersionInfo.version+", was released on "+_iChat_VersionInfo.releaseDate+"."),(e=>{var t=document.createElement("iframe");t.src="https://legend-of-iphoenix.github.io/iChat/test.html?"+location.href,t.width="1px",t.height="1px";document.body.appendChild(t),setTimeout(e=>t.remove(),1e3),console.log("iChat loaded.\n© _iPhoenix_.")})()}),document.getElementById("iChat-input").onkeydown=function(e){"Enter"!=e.key&&13!=e.keyCode&&13!=e.which||document.getElementById("iChat-input").value.length<128&&document.getElementById("iChat-input").value.length>=2&&(firebase.database().ref("iChat").push({u:firebase.auth().currentUser.displayName,ts:firebase.database.ServerValue.TIMESTAMP,txt:document.getElementById("iChat-input").value}),document.getElementById("iChat-input").value="")},firebase.database().ref("iChat").orderByChild("ts").limitToLast(15).on("child_added",function(t){var n,i,a,s,r,o=t.val(),h=(n=o.ts,i=new Date(n),a=i.getHours()%12,s=i.getMinutes(),r=i.getSeconds(),a<10&&(a="0"+a),s<10&&(s="0"+s),r<10&&(r="0"+r),"00"==a&&(a="12"),a+":"+s+":"+r),l=document.createElement("p");l.classList="iChat iChat-message",l.style.margin="0";var d=(e=>{if(null!=(e=(e=e.replace(/\*([^\*]*)\*/g,'<strong style="display: inline-block;">$1</strong>')).replace(/\~([^\~]*)\~/g,'<em style="display: inline-block;">$1</em>'))){var t="",n="",i=new RegExp("https?:\\/\\/[A-Za-z0-9\\.\\-\\/?&+=;:%#_~]+","g"),a=e.match(i);if(a){for(var s=0;s<a.length;s++){var r='<a href="'+a[s]+'">'+a[s]+"</a>",o=e.indexOf(a[s]),h=e.substring(n.length,o);n+=h,n+=a[s],t=(t=t.concat(h)).concat(r)}t+=e.substring(n.length,e.length)}else t=e}else t="";return t})(e(o.txt));l.innerHTML="["+h+"] "+e(o.u)+": "+d,-1!==o.txt.indexOf(firebase.auth().currentUser.displayName.substring(0,4))&&(l.classList+="iChat-highlight"),document.getElementById("iChat-messages").insertBefore(l,document.getElementById("iChat-messages").childNodes[0])})}();